<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regulation Comments Analysis - Comment Analysis Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.5;
            background: #f8f9fa;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2em;
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        
        .section {
            background: white;
            margin: 30px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        .filters-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
        }
        
        .filters-header {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .filter-label {
            font-weight: 500;
            color: #333;
            font-size: 0.9em;
        }
        
        .filterable {
            position: relative;
            cursor: pointer;
        }
        
        .filter-arrow {
            float: right;
            font-size: 12px;
            color: #666;
            margin-left: 8px;
            user-select: none;
        }
        
        .filter-arrow:hover {
            color: #007bff;
        }
        
        .filter-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
            padding: 10px;
            min-width: 200px;
        }
        
        .filter-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 1px rgba(0,123,255,0.25);
        }
        
        .filter-checkbox {
            display: block;
            margin: 5px 0;
            font-size: 13px;
            cursor: pointer;
        }
        
        .filter-checkbox input {
            margin-right: 6px;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
        }
        
        .checkbox-item input[type="checkbox"] {
            margin: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th {
            background: #e9ecef;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #dee2e6;
            vertical-align: top;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
        }
        
        .stance-for {
            background: #28a745;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-against {
            background: #dc3545;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-neutral {
            background: #ffc107;
            color: #212529;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-unknown {
            background: #6c757d;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stances-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            max-width: 300px;
        }
        
        .stance-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            border: 1px solid #bbdefb;
        }
        
        .text-preview {
            max-width: 300px;
            max-height: 100px;
            overflow: hidden;
            font-size: 12px;
        }
        
        .comment-id {
            font-family: monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
        }
        
        .comment-id a:hover {
            color: #0056b3 !important;
            background-color: #e3f2fd;
        }
        
        .date-cell {
            white-space: nowrap;
            font-size: 12px;
        }
        
        .attachment-indicator {
            font-size: 16px;
            color: #28a745;
        }
        
        .unique-indicator {
            background: #28a745;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .duplicate-indicator {
            background: #ffc107;
            color: #212529;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .meta-info {
            background: #343a40;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .meta-label {
            font-size: 0.8em;
            opacity: 0.8;
        }
        
        .meta-value {
            font-weight: 600;
        }
        
        
        .clear-filters {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .clear-filters:hover {
            background: #c82333;
        }
        
        .show-hide-columns {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .show-hide-columns:hover {
            background: #0056b3;
        }
        
        .column-visibility-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .column-visibility-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 250px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1000;
            border-radius: 4px;
            padding: 10px;
            border: 1px solid #ddd;
            top: 100%;
            left: 0;
        }
        
        .column-visibility-content.show {
            display: block;
        }
        
        .column-visibility-item {
            display: flex;
            align-items: center;
            padding: 5px 0;
            gap: 8px;
        }
        
        .column-visibility-item input[type="checkbox"] {
            margin: 0;
        }
        
        .column-visibility-item label {
            cursor: pointer;
            font-size: 14px;
            margin: 0;
        }
        
        .char-limited {
            cursor: help;
        }
        
        /* Custom tooltip styling for wider tooltips */
        .tooltip .tooltip-inner {
            max-width: 600px !important;
            width: auto !important;
            text-align: left !important;
            font-size: 13px !important;
            line-height: 1.4 !important;
            padding: 8px 12px !important;
        }
        
        /* Allow table to be wider and let columns size naturally */
        table {
            width: 100%;
            table-layout: auto;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Only constrain the comment column to prevent it from being too wide */
        th[data-column="5"] {
            width: 25%;
            max-width: 400px;
        }
        
        .text-preview {
            max-width: 400px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Co-occurrence table styles */
        .cooccurrence-table {
            border-collapse: collapse;
            font-size: 12px;
            margin: 0 auto;
        }
        
        .cooccurrence-table th,
        .cooccurrence-table td {
            border: 1px solid #dee2e6;
            text-align: center;
            padding: 8px;
            min-width: 40px;
        }
        
        .cooccurrence-table .stance-label {
            text-align: left;
            font-weight: 500;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .rotate-header {
            height: 150px;
            white-space: nowrap;
            vertical-align: bottom;
        }
        
        .rotate-header > div {
            transform: translate(15px, 65px) rotate(-45deg);
            width: 30px;
            transform-origin: bottom left;
            font-size: 11px;
            font-weight: 500;
        }
        
        .diagonal-cell {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #333;
        }
        
        .cooccurrence-cell {
            color: #333;
            font-weight: 500;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Regulation Comments Analysis</h1>
            <div class="subtitle">Analysis of public comments on federal regulation</div>
            
        </div>
        
        <!-- Summary Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">10</div>
                <div class="stat-label">Total Comments</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">With Attachments</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">1,055</div>
                <div class="stat-label">Avg. Characters</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">2025-06-28</div>
                <div class="stat-label">Date Range</div>
            </div>
        </div>


        <!-- Analysis Field Distributions -->
        
        <div class="section">
            <h2>📊 Stances Distribution</h2>
            <p style="color: #666; margin-bottom: 20px; font-style: italic;">Click on any stance to see how it relates to others</p>
            <div class="expandable-stances">
                
                <div class="expandable-stance-card">
                    <div class="stance-header" onclick="toggleStanceDetails(0)">
                        <span class="stance-count">10</span>
                        <span class="stance-name">Opposition to Politicization of the Civil Service/Schedule F</span>
                        <span class="expand-icon" id="icon-0">▼</span>
                    </div>
                    <div class="stance-details" id="details-0" style="display: none;">
                        <div class="connection-item">80% also: Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</div><div class="connection-item">20% also: Opposition to Political Interference in Scientific and Grantmaking Roles</div>
                    </div>
                </div>
                <div class="expandable-stance-card">
                    <div class="stance-header" onclick="toggleStanceDetails(1)">
                        <span class="stance-count">8</span>
                        <span class="stance-name">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span>
                        <span class="expand-icon" id="icon-1">▼</span>
                    </div>
                    <div class="stance-details" id="details-1" style="display: none;">
                        <div class="connection-item">100% also: Opposition to Politicization of the Civil Service/Schedule F</div><div class="connection-item">12% also: Opposition to Political Interference in Scientific and Grantmaking Roles</div>
                    </div>
                </div>
                <div class="expandable-stance-card">
                    <div class="stance-header" onclick="toggleStanceDetails(2)">
                        <span class="stance-count">2</span>
                        <span class="stance-name">Opposition to Political Interference in Scientific and Grantmaking Roles</span>
                        <span class="expand-icon" id="icon-2">▼</span>
                    </div>
                    <div class="stance-details" id="details-2" style="display: none;">
                        <div class="connection-item">100% also: Opposition to Politicization of the Civil Service/Schedule F</div><div class="connection-item">50% also: Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</div>
                    </div>
                </div>
            </div>
        </div>
        
        <style>
        .expandable-stances {
            display: grid;
            gap: 12px;
        }
        
        .expandable-stance-card {
            background: white;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .stance-header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .stance-header:hover {
            background-color: #f8f9fa;
        }
        
        .stance-count {
            font-size: 1.6em;
            font-weight: bold;
            color: #2c3e50;
            min-width: 80px;
            flex-shrink: 0;
        }
        
        .stance-name {
            font-size: 1em;
            color: #2c3e50;
            line-height: 1.3;
            font-weight: 500;
            flex-grow: 1;
        }
        
        .expand-icon {
            font-size: 1.2em;
            color: #7f8c8d;
            transition: transform 0.3s;
            flex-shrink: 0;
        }
        
        .expand-icon.expanded {
            transform: rotate(180deg);
        }
        
        .stance-details {
            padding: 0 15px 15px 15px;
            border-top: 1px solid #ecf0f1;
            background: #f8f9fa;
        }
        
        .connection-item {
            padding: 8px 10px;
            margin: 8px 0;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #e67e22;
            font-size: 0.9em;
            color: #2c3e50;
        }
        
        .no-connections {
            padding: 15px;
            text-align: center;
            color: #888;
            font-style: italic;
        }
        </style>
        
        <script>
        function toggleStanceDetails(index) {
            const details = document.getElementById('details-' + index);
            const icon = document.getElementById('icon-' + index);
            
            if (details.style.display === 'none' || details.style.display === '') {
                details.style.display = 'block';
                icon.classList.add('expanded');
            } else {
                details.style.display = 'none';
                icon.classList.remove('expanded');
            }
        }
        </script>

        <!-- Comments Table -->
        <div class="section">
            <h2>Comments</h2>
            <div class="table-controls">
                <button class="clear-filters" onclick="clearAllFilters()">Clear All Filters</button>
                <div class="column-visibility-dropdown">
                    <button class="show-hide-columns" onclick="toggleColumnVisibility()">Show/Hide Columns</button>
                    <div class="column-visibility-content" id="columnVisibilityDropdown">
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-0" checked onchange="toggleColumn(0)">
                            <label for="col-0">Comment ID</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-1" checked onchange="toggleColumn(1)">
                            <label for="col-1">Date</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-2" checked onchange="toggleColumn(2)">
                            <label for="col-2">Submitter</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-3" checked onchange="toggleColumn(3)">
                            <label for="col-3">Organization</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-4" checked onchange="toggleColumn(4)">
                            <label for="col-4">Stances</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-5" checked onchange="toggleColumn(5)">
                            <label for="col-5">New Stances</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-6" checked onchange="toggleColumn(6)">
                            <label for="col-6">Comment</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-7" checked onchange="toggleColumn(7)">
                            <label for="col-7">Attachments</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-8" checked onchange="toggleColumn(8)">
                            <label for="col-8">Dup Count</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-9" checked onchange="toggleColumn(9)">
                            <label for="col-9">Dup Ratio</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-10" onchange="toggleColumn(10)">
                            <label for="col-10">Attachment</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-11" onchange="toggleColumn(11)">
                            <label for="col-11">Key Quote (LLM)</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-12" onchange="toggleColumn(12)">
                            <label for="col-12">Rationale (LLM)</label>
                        </div>
                    </div>
                </div>
            </div>
                
            <div style="overflow-x: auto;">
                <table id="commentsTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th class="filterable" data-column="0">
                                Comment ID <span class="filter-arrow" onclick="toggleFilter(0)">▼</span>
                                <div class="filter-dropdown" id="filter-0" style="display: none;">
                                    <input type="text" class="filter-input" data-column="0" placeholder="Filter ID..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th>Date</th>
                            <th class="filterable" data-column="2">
                                Submitter <span class="filter-arrow" onclick="toggleFilter(2)">▼</span>
                                <div class="filter-dropdown" id="filter-2" style="display: none;">
                                    <input type="text" class="filter-input" data-column="2" placeholder="Filter name..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="3">
                                Organization <span class="filter-arrow" onclick="toggleFilter(3)">▼</span>
                                <div class="filter-dropdown" id="filter-3" style="display: none;">
                                    <input type="text" class="filter-input" data-column="3" placeholder="Filter organization..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="4">
                                Stances <span class="filter-arrow" onclick="toggleFilter(4)">▼</span>
                                <div class="filter-dropdown" id="filter-4" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Opposition to Political Interference in Scientific and Grantmaking Roles" onchange="filterTable()"> Opposition to Political Interference in Scientific and Grantmaking Roles</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Opposition to Politicization of the Civil Service/Schedule F" onchange="filterTable()"> Opposition to Politicization of the Civil Service/Schedule F</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)" onchange="filterTable()"> Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</label>
                                    <hr style="margin: 5px 0;">
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="unusual_combo" value="yes" onchange="filterTable()"> ⚠️ Unusual Combinations</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="5">
                                New Stances <span class="filter-arrow" onclick="toggleFilter(5)">▼</span>
                                <div class="filter-dropdown" id="filter-5" style="display: none;">
                                </div>
                            </th>
                            <th class="filterable" data-column="6">
                                Comment <span class="filter-arrow" onclick="toggleFilter(6)">▼</span>
                                <div class="filter-dropdown" id="filter-6" style="display: none;">
                                    <input type="text" class="filter-input" data-column="6" placeholder="Search comment text..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="7">
                                📎 <span class="filter-arrow" onclick="toggleFilter(7)">▼</span>
                                <div class="filter-dropdown" id="filter-7" style="display: none;">
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="attachments" value="yes" onchange="filterTable()"> With attachments</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="attachments" value="no" onchange="filterTable()"> No attachments</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="8">
                                Dup Count <span class="filter-arrow" onclick="toggleFilter(8)">▼</span>
                                <div class="filter-dropdown" id="filter-8" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="duplication_count" value="1" onchange="filterTable()"> 1</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="9">
                                Dup Ratio <span class="filter-arrow" onclick="toggleFilter(9)">▼</span>
                                <div class="filter-dropdown" id="filter-9" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="duplication_ratio" value="1" onchange="filterTable()"> 1:1</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="10" style="display: none;">
                                Attachment <span class="filter-arrow" onclick="toggleFilter(10)">▼</span>
                                <div class="filter-dropdown" id="filter-10" style="display: none;">
                                    <input type="text" class="filter-input" data-column="10" placeholder="Search attachment text..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="11" style="display: none;">
                                Key Quote <span class="filter-arrow" onclick="toggleFilter(11)">▼</span>
                                <div class="filter-dropdown" id="filter-11" style="display: none;">
                                    <input type="text" class="filter-input" data-column="11" placeholder="Search quotes..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="12" style="display: none;">
                                Rationale <span class="filter-arrow" onclick="toggleFilter(12)">▼</span>
                                <div class="filter-dropdown" id="filter-12" style="display: none;">
                                    <input type="text" class="filter-input" data-column="12" placeholder="Search rationale..." onkeyup="filterTable()">
                                </div>
                            </th>
                        </tr>
                    </thead>
                        <tbody>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-32539" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-32539</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="I strongly oppose these changes that will politicize the civil service. through reclassifying government employees into policymaking positions. Through successive administrations of both parties, our government workers serve faithfully and without favor to keep services going for the American people. They should not have to deal with political machinations. Many workers could have higher paying prestigious positions in private companies, but they are loyal to the American government and the job security they have allows them to forego more lucrative options. We do not want to lose this kind of dedication.">I strongly oppose these changes that will politicize the civil service. through reclassifying government employees into policymaking positions. Through successive administrations of both parties, our government workers serve faithfully and without favor to keep services going for the American people...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">I strongly oppose these changes that will politicize the civil service.</td>
                                <td style="display: none;">The comment explicitly expresses strong opposition to the politicization of the civil service and emphasizes the importance of loyalty and job security for government workers, which aligns with concerns about protecting civil service integrity and worker rights.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-35247" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-35247</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="I am against the proposed rule by the OPM. These positions  need to remain as they are under the rules in place. Rank and file civil service employees should be immune from politically motivated decisions to terminate them. We need our civil service to be nonpartisan as their careers may extend through multiple administrations. Placing their employment to at will would facilitate politically motivated removal every 4 years when republican administrations are replaced by democrat administrations. The expedited potential removal of career civil servants for non performance criteria will drain agencies of crucial talent and experience.   There are already procedures in place to remove civil servants who are under performing from their positions. Our dedicated civil servants deserve more from our government than the uncertainty this proposed rule would create.">I am against the proposed rule by the OPM. These positions  need to remain as they are under the rules in place. Rank and file civil service employees should be immune from politically motivated decisions to terminate them. We need our civil service to be nonpartisan as their careers may extend thro...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Rank and file civil service employees should be immune from politically motivated decisions to terminate them.</td>
                                <td style="display: none;">The commenter clearly opposes the proposed rule by expressing concerns about the politicization of civil service positions and the negative implications of at-will employment on government operations. Additionally, they highlight the importance of due process and established procedures for addressing underperformance, showing an opposition to weakening worker protections.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-10666" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-10666</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview">I oppose the replacement of expert apolitical civil servants who pledged to support and defend the US Constitution with a cadre of individuals who support a particular political party. 
To remove their protection from job termination without cause is unconstitutional. </td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">I oppose the replacement of expert apolitical civil servants who pledged to support and defend the US Constitution with a cadre of individuals who support a particular political party.</td>
                                <td style="display: none;">The comment clearly expresses opposition to the politicization of civil service roles, highlighting the importance of maintaining expert, nonpartisan civil servants. Additionally, it emphasizes the unconstitutionality of removing job termination protections, indicating a concern for due process and worker rights.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-24999" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-24999</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="It is vital to the smooth running of our government agencies that civil service jobs NOT be polititicized.  We simply cannot reinvent the wheel every time an administration changes.  We rely on the experience of career civil servants to keep things running smoothly when these changes take place.

Civil servants deserve to have job security.  Taking this away would lower morale and cause an even greater exodus from this vital work force, causing inefficiency, confusion, and understaffing.

I believe this proposal is primarily about politicizing the civil service.  I do not believe it is about making it easier to get rid of &quot;bad&quot; employees, at least not if &quot;bad&quot; is viewed as a measure of job performance rather than political convictions.  Saying otherwise is a lie.  Repeating that lie more loudly while smirking is not a convincing argument to the contrary.">It is vital to the smooth running of our government agencies that civil service jobs NOT be polititicized.  We simply cannot reinvent the wheel every time an administration changes.  We rely on the experience of career civil servants to keep things running smoothly when these changes take place.

Ci...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">It is vital to the smooth running of our government agencies that civil service jobs NOT be politicized.</td>
                                <td style="display: none;">The commenter clearly opposes the politicization of civil service roles, emphasizing the importance of career civil servants for continuity and efficiency in government operations. Additionally, the concern for job security and its impact on morale aligns with opposition to weakening federal due process and worker protections.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-25094" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-25094</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Political Interference in Scientific and Grantmaking Roles</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="I strongly oppose the Proposed Rule on Improving Performance, Accountability and Responsiveness in the Civil Service (“Schedule Policy/Career”) because it threatens the integrity and effectiveness of our federal workforce. By stripping civil service protections from employees whose roles are deemed to “influence policy,” this rule undermines the objectivity and independence that are essential to sound, evidence-based decision-making in government. It opens the door to political pressure on scientific, technical, and policy professionals—those we rely on for everything from nuclear safety to public health, cybersecurity, and economic analysis. Turning these roles into “at-will” positions risks creating a culture of fear and self-preservation, where professionals may feel compelled to suppress inconvenient truths rather than serve the public interest. This change would not only jeopardize individual careers but also erode the government’s capacity to pursue long-term, mission-driven research and policy grounded in facts. For the sake of effective governance and public trust, this rule must be rejected.">I strongly oppose the Proposed Rule on Improving Performance, Accountability and Responsiveness in the Civil Service (“Schedule Policy/Career”) because it threatens the integrity and effectiveness of our federal workforce. By stripping civil service protections from employees whose roles are deemed ...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">By stripping civil service protections from employees whose roles are deemed to 'influence policy,' this rule undermines the objectivity and independence that are essential to sound, evidence-based decision-making in government.</td>
                                <td style="display: none;">The comment expresses clear opposition to the proposed rule, citing concerns about the threats to the integrity and independence of the federal workforce, especially in scientific and policy roles. Additionally, it highlights the risks to due process and the culture of fear that would result from the proposed changes, aligning with multiple existing stances.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-1895" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-1895</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Political Interference in Scientific and Grantmaking Roles</span> <span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="Substantive participation and discretionary authority in agency grantmaking, such as the substantive exercise of discretion in the drafting of funding opportunity announcements, evaluation of grant applications, or recommending or selecting grant recipients. Grantmaking is an important form of policymaking, so employees with a substantive discretionary role in how federal funding gets allocated may occupy policymaking positions.&quot;

The proposed change would frame grantmaking as policy. Thus, those involved in grantmaking would be political appointees, and would influence the evaluation and awarding of grant funding according to the agenda of whichever President was in power.

Adopting this proposed change would have egregious consequences for our country&#039;s ability to conduct world-leading scientific research and educate a competitive scientific workforce.

Instead, those involved in grantmaking should be nonpartisan, career civil servants with appropriate expertise and experience to write funding announcements, evaluate grant opportunities, and recommend grant funding to achieve the missions of their agencies.

Thus, the proposed change should be rejected.">Substantive participation and discretionary authority in agency grantmaking, such as the substantive exercise of discretion in the drafting of funding opportunity announcements, evaluation of grant applications, or recommending or selecting grant recipients. Grantmaking is an important form of polic...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Adopting this proposed change would have egregious consequences for our country's ability to conduct world-leading scientific research and educate a competitive scientific workforce.</td>
                                <td style="display: none;">The comment expresses clear opposition to the proposed changes to grantmaking roles by emphasizing the importance of keeping these positions nonpartisan and filled by career civil servants. It warns against the politicization of roles that are critical to scientific research, thus aligning with the stances on both scientific integrity and protection of civil service independence.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-30504" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-30504</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview">Civil servants swear a oath to the constitution not the current administration the oath to the regime was required in World War Two Germany </td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Civil servants swear a oath to the constitution not the current administration the oath to the regime was required in World War Two Germany.</td>
                                <td style="display: none;">The comment expresses a clear opposition to politicizing civil servants, emphasizing their constitutional oath rather than loyalty to the current administration, which aligns with concerns about maintaining a nonpartisan civil service. Additionally, the mention of historical parallels to a regime suggests a caution against undermining worker protections, indicating a defense of due process for federal employees.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-29325" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-29325</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="Creating many Schedule F positions is a shift from the merit based system to a highly politicized system.  The “spoils system” was rejected long ago as a bad way to run our government. Returning to that is a vey bad step backward.  Characterizing Schedule F as if it is the solution to poor performance to achieve “accountability” is deceptive. Mixing up “poor performance” with loyalty to political policy preferences is wrong.  Seeking to address poor performance is good. Firing people due to perceived lack of loyalty or because of political views is bad. Most career employees are not political animals, and should not be treated as such.

Most positions are not policy positions. For example, engineering and science duties rarely involve setting policies.  They are technical. Congress or a given administration might set policies, but not scientists and engineers. So if there was a poor performer doing technical work, terminating them on the basis of policy implementation makes no sense. 

If we want a professionally run, efficient government, more political career professionals is not what is needed. Merit based competitive hiring is the status quo. Employees are accustomed to having administrations come and go, and adapting to shifting priorities. The paranoid assumption that career federal employees are insubordinate, ignoring rules and laws and doing what they want is fiction. 

My observation over the years is that when we hear about illegal or fraudulent activity in an agen... [truncated]">Creating many Schedule F positions is a shift from the merit based system to a highly politicized system.  The “spoils system” was rejected long ago as a bad way to run our government. Returning to that is a vey bad step backward.  Characterizing Schedule F as if it is the solution to poor performan...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Creating many Schedule F positions is a shift from the merit based system to a highly politicized system. The 'spoils system' was rejected long ago as a bad way to run our government.</td>
                                <td style="display: none;">The commenter clearly expresses opposition to the implementation of Schedule F, highlighting concerns about reverting to a politicized system that undermines merit-based hiring. Additionally, they emphasize the importance of due process and protections for federal employees against arbitrary dismissals based on political loyalty rather than performance.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-1119" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-1119</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview">This is clearly a naked attempt by the Trump admin to politicize the civil service and replace longtime employees with loyalist sycophants. </td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">This is clearly a naked attempt by the Trump admin to politicize the civil service and replace longtime employees with loyalist sycophants.</td>
                                <td style="display: none;">The comment explicitly opposes the politicization of the civil service and highlights concerns about replacing experienced employees with those who are politically loyal, clearly aligning with the stance against the reimplementation of Schedule F.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/OPM-2025-0004-3504" target="_blank" style="color: #007bff; text-decoration: underline;">OPM-2025-0004-3504</a></span></td>
                                <td class="date-cell">2025-06-28</td>
                                <td></td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Opposition to Politicization of the Civil Service/Schedule F</span> <span class="stance-tag">Opposition to Weakening Federal Due Process and Worker Protections (General Civil Service Rights)</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="The proposed implementation of Schedule F represents a fundamental threat to the principles of good governance and the very structure of our civil service. It&#039;s not merely a bureaucratic adjustment; it&#039;s a potentially seismic shift that could destabilize the federal workforce and undermine the ability of our government to function effectively and impartially.

At the heart of the issue is the concept of the merit system, which has been a cornerstone of the federal civil service for decades. This system ensures that federal employees are hired and promoted based on their qualifications and competence, rather than their political affiliations. It fosters a professional, nonpartisan workforce dedicated to serving the public interest, regardless of which political party holds power. Schedule F would dismantle this system by reclassifying certain federal positions, making it easier to hire and fire employees based on political loyalty.

The consequences of such a change would be far-reaching and deeply damaging:

* Politicization of the Civil Service: Schedule F would open the door to widespread politicization of the federal workforce. Career civil servants, who are supposed to be impartial experts, could be replaced by political loyalists with little or no relevant experience. This would erode public trust in government and undermine the ability of agencies to carry out their missions effectively.

* Loss of Expertise and Institutional Memory: Federal employees often spend many y... [truncated]">The proposed implementation of Schedule F represents a fundamental threat to the principles of good governance and the very structure of our civil service. It's not merely a bureaucratic adjustment; it's a potentially seismic shift that could destabilize the federal workforce and undermine the abili...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Schedule F would dismantle this system by reclassifying certain federal positions, making it easier to hire and fire employees based on political loyalty.</td>
                                <td style="display: none;">The comment clearly opposes the implementation of Schedule F, highlighting the threat it poses to the merit-based system and nonpartisan civil service. It emphasizes concerns over politicization and the loss of expertise and institutional memory among federal employees, which aligns with the selected stances.</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Meta Information -->
        <div class="meta-info">
            <h3 style="color: white; margin-bottom: 20px;">📋 Report Details</h3>
            <div class="meta-grid">
                <div class="meta-item">
                    <div class="meta-label">Generated</div>
                    <div class="meta-value">2025-06-28 20:26:48</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Model Used</div>
                    <div class="meta-value">gpt-4o-mini</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Total Comments</div>
                    <div class="meta-value">10</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">With Attachments</div>
                    <div class="meta-value">0</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Average Length</div>
                    <div class="meta-value">1,055 chars</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Date Range</div>
                    <div class="meta-value">2025-06-28</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Column visibility state (13 columns with new_stances)
        const columnVisibility = {
            0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true, 7: true, 8: true, 9: true, 10: false, 11: false, 12: false
        };

        // Initialize column visibility on page load
        document.addEventListener('DOMContentLoaded', function() {
            for (const [col, visible] of Object.entries(columnVisibility)) {
                updateColumnVisibility(parseInt(col), visible);
                // Also update the checkbox state
                const checkbox = document.getElementById('col-' + col);
                if (checkbox) {
                    checkbox.checked = visible;
                }
            }
        });

        function toggleColumnVisibility() {
            const dropdown = document.getElementById('columnVisibilityDropdown');
            dropdown.classList.toggle('show');
        }

        function toggleColumn(columnIndex) {
            const checkbox = document.getElementById('col-' + columnIndex);
            const visible = checkbox.checked;
            columnVisibility[columnIndex] = visible;
            updateColumnVisibility(columnIndex, visible);
        }

        function updateColumnVisibility(columnIndex, visible) {
            const table = document.getElementById('commentsTable');
            const rows = table.getElementsByTagName('tr');
            
            // Update header
            const headers = rows[0].getElementsByTagName('th');
            if (headers[columnIndex]) {
                headers[columnIndex].style.display = visible ? '' : 'none';
            }
            
            // Update all data rows
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells[columnIndex]) {
                    cells[columnIndex].style.display = visible ? '' : 'none';
                }
            }
        }

        function filterTable() {
            const table = document.getElementById('commentsTable');
            const rows = table.getElementsByTagName('tr');
            
            // Get text input filters
            const textFilters = document.querySelectorAll('.filter-input');
            const textFilterValues = Array.from(textFilters).map(filter => {
                return {
                    column: parseInt(filter.getAttribute('data-column')),
                    value: filter.value.toLowerCase()
                };
            });
            
            // Get checkbox filters
            const stanceCheckboxes = document.querySelectorAll('input[data-filter="stances"]:checked');
            const newStanceCheckboxes = document.querySelectorAll('input[data-filter="new_stances"]:checked');
            const unusualComboCheckboxes = document.querySelectorAll('input[data-filter="unusual_combo"]:checked');
            const attachmentCheckboxes = document.querySelectorAll('input[data-filter="attachments"]:checked');
            const duplicationCountCheckboxes = document.querySelectorAll('input[data-filter="duplication_count"]:checked');
            const duplicationRatioCheckboxes = document.querySelectorAll('input[data-filter="duplication_ratio"]:checked');
            
            const selectedStances = Array.from(stanceCheckboxes).map(cb => cb.value.toLowerCase());
            const selectedNewStances = Array.from(newStanceCheckboxes).map(cb => cb.value.toLowerCase());
            const filterUnusualCombos = unusualComboCheckboxes.length > 0;
            const selectedAttachments = Array.from(attachmentCheckboxes).map(cb => cb.value);
            const selectedDuplicationCounts = Array.from(duplicationCountCheckboxes).map(cb => parseInt(cb.value));
            const selectedDuplicationRatios = Array.from(duplicationRatioCheckboxes).map(cb => parseInt(cb.value));

            // Always assume new_stances column exists (column 5)
            const hasNewStances = true;
            
            // Filter each row
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                const cells = row.getElementsByTagName('td');
                let showRow = true;

                // Check text filters
                for (const filter of textFilterValues) {
                    if (filter.value && filter.column < cells.length) {
                        const cellText = cells[filter.column].textContent.toLowerCase();
                        if (!cellText.includes(filter.value)) {
                            showRow = false;
                            break;
                        }
                    }
                }
                
                // Check stance filter (column 4)
                if (showRow && selectedStances.length > 0) {
                    const stanceText = cells[4].textContent.toLowerCase();
                    if (!selectedStances.some(stance => stanceText.includes(stance))) {
                        showRow = false;
                    }
                }
                
                // Check unusual combination filter
                if (showRow && filterUnusualCombos) {
                    const stanceCell = cells[4].innerHTML;
                    if (!stanceCell.includes('⚠️')) {
                        showRow = false;
                    }
                }
                
                // Check new stance filter (column 5 if exists)
                if (showRow && hasNewStances && selectedNewStances.length > 0) {
                    const newStanceText = cells[5].textContent.toLowerCase();
                    if (!selectedNewStances.some(stance => newStanceText.includes(stance))) {
                        showRow = false;
                    }
                }
                
                // Column positions shift by 1 when new_stances exists
                const attachmentCol = hasNewStances ? 7 : 6;
                const dupCountCol = hasNewStances ? 8 : 7;
                const dupRatioCol = hasNewStances ? 9 : 8;
                
                // Check attachments filter
                if (showRow && selectedAttachments.length > 0) {
                    const attachmentCell = cells[attachmentCol];
                    const hasAttachment = attachmentCell.textContent.trim() !== '';
                    
                    let attachmentMatch = false;
                    for (const filter of selectedAttachments) {
                        if (filter === 'yes' && hasAttachment) {
                            attachmentMatch = true;
                            break;
                        }
                        if (filter === 'no' && !hasAttachment) {
                            attachmentMatch = true;
                            break;
                        }
                    }
                    
                    if (!attachmentMatch) {
                        showRow = false;
                    }
                }
                
                // Check duplication count filter
                if (showRow && selectedDuplicationCounts.length > 0) {
                    const duplicationCell = cells[dupCountCol];
                    const duplicationText = duplicationCell.textContent.trim();
                    const duplicationCount = parseInt(duplicationText);
                    
                    if (!selectedDuplicationCounts.includes(duplicationCount)) {
                        showRow = false;
                    }
                }
                
                // Check duplication ratio filter
                if (showRow && selectedDuplicationRatios.length > 0) {
                    const ratioCell = cells[dupRatioCol];
                    const ratioText = ratioCell.textContent.trim();
                    // Extract number after "1:" (e.g., "1:10" -> 10)
                    const ratioMatch = ratioText.match(/1:(\d+)/);
                    const ratioValue = ratioMatch ? parseInt(ratioMatch[1]) : 1;
                    
                    if (!selectedDuplicationRatios.includes(ratioValue)) {
                        showRow = false;
                    }
                }

                row.style.display = showRow ? '' : 'none';
            }
        }
        
        function toggleFilter(columnIndex) {
            const dropdown = document.getElementById('filter-' + columnIndex);
            const allDropdowns = document.querySelectorAll('.filter-dropdown');
            
            // Close all other dropdowns
            allDropdowns.forEach(dd => {
                if (dd !== dropdown) {
                    dd.style.display = 'none';
                }});
            
            // Toggle current dropdown
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
        
        function clearAllFilters() {
            const textFilters = document.querySelectorAll('.filter-input');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            
            textFilters.forEach(filter => filter.value = '');
            checkboxes.forEach(checkbox => checkbox.checked = false);
            
            filterTable();
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const isFilterClick = event.target.closest('.filterable') || event.target.closest('.filter-dropdown');
            const isColumnVisClick = event.target.closest('.column-visibility-dropdown');
            
            if (!isFilterClick) {
                document.querySelectorAll('.filter-dropdown').forEach(dd => {
                    dd.style.display = 'none';
                });
            }
            
            if (!isColumnVisClick) {
                document.getElementById('columnVisibilityDropdown').classList.remove('show');
            }
        });
        
        // Initialize Bootstrap tooltips
        function initializeTooltips() {
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
            [...tooltipTriggerList].forEach(tooltipTriggerEl => {
                try {
                    // Dispose existing tooltip if any
                    const existingTooltip = bootstrap.Tooltip.getInstance(tooltipTriggerEl);
                    if (existingTooltip) {
                        existingTooltip.dispose();
                    }
                    
                    // Create new tooltip
                    new bootstrap.Tooltip(tooltipTriggerEl, {
                        boundary: document.body,
                        trigger: 'hover focus',
                        container: 'body'
                    });
                } catch (err) {
                    console.error('Error initializing tooltip:', err);
                }
            });
        }
        
        // Initialize tooltips when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeTooltips();
        });
    </script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
