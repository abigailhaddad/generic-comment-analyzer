<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regulation Comments Analysis - Comment Analysis Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.5;
            background: #f8f9fa;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2em;
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        
        .section {
            background: white;
            margin: 30px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        .filters-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
        }
        
        .filters-header {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .filter-label {
            font-weight: 500;
            color: #333;
            font-size: 0.9em;
        }
        
        .filterable {
            position: relative;
            cursor: pointer;
        }
        
        .filter-arrow {
            float: right;
            font-size: 12px;
            color: #666;
            margin-left: 8px;
            user-select: none;
        }
        
        .filter-arrow:hover {
            color: #007bff;
        }
        
        .filter-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
            padding: 10px;
            min-width: 200px;
        }
        
        .filter-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 1px rgba(0,123,255,0.25);
        }
        
        .filter-checkbox {
            display: block;
            margin: 5px 0;
            font-size: 13px;
            cursor: pointer;
        }
        
        .filter-checkbox input {
            margin-right: 6px;
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
        }
        
        .checkbox-item input[type="checkbox"] {
            margin: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th {
            background: #e9ecef;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            position: sticky;
            top: 0;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #dee2e6;
            vertical-align: top;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
        }
        
        .stance-for {
            background: #28a745;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-against {
            background: #dc3545;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-neutral {
            background: #ffc107;
            color: #212529;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stance-unknown {
            background: #6c757d;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .stances-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            max-width: 300px;
        }
        
        .stance-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            border: 1px solid #bbdefb;
        }
        
        .text-preview {
            max-width: 300px;
            max-height: 100px;
            overflow: hidden;
            font-size: 12px;
        }
        
        .comment-id {
            font-family: monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
        }
        
        .comment-id a:hover {
            color: #0056b3 !important;
            background-color: #e3f2fd;
        }
        
        .date-cell {
            white-space: nowrap;
            font-size: 12px;
        }
        
        .attachment-indicator {
            font-size: 16px;
            color: #28a745;
        }
        
        .unique-indicator {
            background: #28a745;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .duplicate-indicator {
            background: #ffc107;
            color: #212529;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .meta-info {
            background: #343a40;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .meta-label {
            font-size: 0.8em;
            opacity: 0.8;
        }
        
        .meta-value {
            font-weight: 600;
        }
        
        
        .clear-filters {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .clear-filters:hover {
            background: #c82333;
        }
        
        .show-hide-columns {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .show-hide-columns:hover {
            background: #0056b3;
        }
        
        .column-visibility-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .column-visibility-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 250px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1000;
            border-radius: 4px;
            padding: 10px;
            border: 1px solid #ddd;
            top: 100%;
            left: 0;
        }
        
        .column-visibility-content.show {
            display: block;
        }
        
        .column-visibility-item {
            display: flex;
            align-items: center;
            padding: 5px 0;
            gap: 8px;
        }
        
        .column-visibility-item input[type="checkbox"] {
            margin: 0;
        }
        
        .column-visibility-item label {
            cursor: pointer;
            font-size: 14px;
            margin: 0;
        }
        
        .char-limited {
            cursor: help;
        }
        
        /* Custom tooltip styling for wider tooltips */
        .tooltip .tooltip-inner {
            max-width: 600px !important;
            width: auto !important;
            text-align: left !important;
            font-size: 13px !important;
            line-height: 1.4 !important;
            padding: 8px 12px !important;
        }
        
        /* Allow table to be wider and let columns size naturally */
        table {
            width: 100%;
            table-layout: auto;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Only constrain the comment column to prevent it from being too wide */
        th[data-column="5"] {
            width: 25%;
            max-width: 400px;
        }
        
        .text-preview {
            max-width: 400px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        /* Co-occurrence table styles */
        .cooccurrence-table {
            border-collapse: collapse;
            font-size: 12px;
            margin: 0 auto;
        }
        
        .cooccurrence-table th,
        .cooccurrence-table td {
            border: 1px solid #dee2e6;
            text-align: center;
            padding: 8px;
            min-width: 40px;
        }
        
        .cooccurrence-table .stance-label {
            text-align: left;
            font-weight: 500;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .rotate-header {
            height: 150px;
            white-space: nowrap;
            vertical-align: bottom;
        }
        
        .rotate-header > div {
            transform: translate(15px, 65px) rotate(-45deg);
            width: 30px;
            transform-origin: bottom left;
            font-size: 11px;
            font-weight: 500;
        }
        
        .diagonal-cell {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #333;
        }
        
        .cooccurrence-cell {
            color: #333;
            font-weight: 500;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Regulation Comments Analysis</h1>
            <div class="subtitle">Analysis of public comments on federal regulation</div>
            
        </div>
        
        <!-- Summary Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">5</div>
                <div class="stat-label">Total Comments</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">0</div>
                <div class="stat-label">With Attachments</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">1,775</div>
                <div class="stat-label">Avg. Characters</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">2025-06-19 to 2025-06-23</div>
                <div class="stat-label">Date Range</div>
            </div>
        </div>


        <!-- Analysis Field Distributions -->
        
            <div class="section">
                <h2>📊 Themes Distribution</h2>
                <p style="color: #666; margin-bottom: 20px; font-style: italic;">Click on any theme to see positions, then click positions to see relationships</p>
                <div class="theme-stances">
                    
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(0)">
                            <span class="theme-name">🔹 Public Health vs. Personal Autonomy</span>
                            <span class="theme-count">(1 positions)</span>
                            <span class="expand-icon" id="theme-icon-0">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-0" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(0_0)">
                                <span class="position-count">3</span>
                                <span class="position-name">Emphasis on Public Health Responsibility</span>
                                <span class="expand-icon" id="pos-icon-0_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-0_0" style="display: none;">
                                <div class="connection-item">67% also: Universal Vaccine Access: Support for Universal Vaccine Access</div><div class="connection-item">67% also: Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</div><div class="connection-item">67% also: Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</div><div class="connection-item">67% also: COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</div><div class="connection-item">33% also: Vaccine Safety and Harms: Vaccines Are Safe and Effective</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(1)">
                            <span class="theme-name">🔹 Importance of Vaccine Recommendations for Insurance and Coverage</span>
                            <span class="theme-count">(1 positions)</span>
                            <span class="expand-icon" id="theme-icon-1">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-1" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(1_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Support for Maintaining Recommendations to Guarantee Coverage</span>
                                <span class="expand-icon" id="pos-icon-1_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-1_0" style="display: none;">
                                <div class="connection-item">100% also: Universal Vaccine Access: Support for Universal Vaccine Access</div><div class="connection-item">100% also: Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</div><div class="connection-item">100% also: Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</div><div class="connection-item">50% also: COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(2)">
                            <span class="theme-name">🔹 Universal Vaccine Access</span>
                            <span class="theme-count">(1 positions)</span>
                            <span class="expand-icon" id="theme-icon-2">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-2" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(2_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Support for Universal Vaccine Access</span>
                                <span class="expand-icon" id="pos-icon-2_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-2_0" style="display: none;">
                                <div class="connection-item">100% also: Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</div><div class="connection-item">100% also: Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</div><div class="connection-item">100% also: Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</div><div class="connection-item">50% also: COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(3)">
                            <span class="theme-name">🔹 Committee Independence and Expertise</span>
                            <span class="theme-count">(1 positions)</span>
                            <span class="expand-icon" id="theme-icon-3">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-3" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(3_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Support for Former (or Traditional) ACIP Expert Panel</span>
                                <span class="expand-icon" id="pos-icon-3_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-3_0" style="display: none;">
                                <div class="connection-item">100% also: Universal Vaccine Access: Support for Universal Vaccine Access</div><div class="connection-item">100% also: Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</div><div class="connection-item">100% also: Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</div><div class="connection-item">50% also: COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(4)">
                            <span class="theme-name">🔹 COVID Vaccine Market Status</span>
                            <span class="theme-count">(2 positions)</span>
                            <span class="expand-icon" id="theme-icon-4">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-4" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(4_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Support for Continued or Expanded COVID Vaccine Access</span>
                                <span class="expand-icon" id="pos-icon-4_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-4_0" style="display: none;">
                                <div class="connection-item">100% also: Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</div><div class="connection-item">50% also: Vaccine Safety and Harms: Vaccines Are Safe and Effective</div><div class="connection-item">50% also: Universal Vaccine Access: Support for Universal Vaccine Access</div><div class="connection-item">50% also: Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</div><div class="connection-item">50% also: Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</div>
                            </div>
                        </div>
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(4_1)">
                                <span class="position-count">2</span>
                                <span class="position-name">Support for Removal of COVID Vaccines from Market</span>
                                <span class="expand-icon" id="pos-icon-4_1">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-4_1" style="display: none;">
                                <div class="connection-item">100% also: Vaccine Safety and Harms: Vaccines Are Unsafe</div><div class="connection-item">100% also: Restoring and Building Public Trust: Trust Depends on Transparency and Safety</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(5)">
                            <span class="theme-name">🔹 Vaccine Safety and Harms</span>
                            <span class="theme-count">(2 positions)</span>
                            <span class="expand-icon" id="theme-icon-5">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-5" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(5_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Vaccines Are Unsafe</span>
                                <span class="expand-icon" id="pos-icon-5_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-5_0" style="display: none;">
                                <div class="connection-item">100% also: Restoring and Building Public Trust: Trust Depends on Transparency and Safety</div><div class="connection-item">100% also: COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market</div>
                            </div>
                        </div>
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(5_1)">
                                <span class="position-count">1</span>
                                <span class="position-name">Vaccines Are Safe and Effective</span>
                                <span class="expand-icon" id="pos-icon-5_1">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-5_1" style="display: none;">
                                <div class="connection-item">100% also: Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</div><div class="connection-item">100% also: COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="theme-card">
                        <div class="theme-header" onclick="toggleThemeDetails(6)">
                            <span class="theme-name">🔹 Restoring and Building Public Trust</span>
                            <span class="theme-count">(1 positions)</span>
                            <span class="expand-icon" id="theme-icon-6">▼</span>
                        </div>
                        <div class="theme-details" id="theme-details-6" style="display: none;">
                            
                        <div class="position-card">
                            <div class="position-header" onclick="togglePositionDetails(6_0)">
                                <span class="position-count">2</span>
                                <span class="position-name">Trust Depends on Transparency and Safety</span>
                                <span class="expand-icon" id="pos-icon-6_0">▼</span>
                            </div>
                            <div class="position-details" id="pos-details-6_0" style="display: none;">
                                <div class="connection-item">100% also: Vaccine Safety and Harms: Vaccines Are Unsafe</div><div class="connection-item">100% also: COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market</div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <style>
            .theme-stances {
                display: grid;
                gap: 15px;
            }
            
            .theme-card {
                background: white;
                border-radius: 8px;
                border-left: 4px solid #2c3e50;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                overflow: hidden;
            }
            
            .theme-header {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px;
                cursor: pointer;
                transition: background-color 0.2s;
                background: #f8f9fa;
                font-weight: 600;
            }
            
            .theme-header:hover {
                background-color: #e9ecef;
            }
            
            .theme-name {
                font-size: 1.1em;
                color: #2c3e50;
                flex: 1;
            }
            
            .theme-count {
                color: #666;
                font-size: 0.9em;
            }
            
            .theme-details {
                padding: 0 15px 15px 15px;
            }
            
            .position-card {
                background: #f8f9fa;
                border-radius: 6px;
                margin: 8px 0;
                border-left: 3px solid #3498db;
            }
            
            .position-header {
                display: flex;
                align-items: flex-start;
                gap: 12px;
                padding: 12px;
                cursor: pointer;
                transition: background-color 0.2s;
            }
            
            .position-header:hover {
                background-color: #ffffff;
            }
            
            .position-count {
                font-size: 1.4em;
                font-weight: bold;
                color: #3498db;
                min-width: 40px;
            }
            
            .position-name {
                flex: 1;
                font-weight: 500;
                color: #2c3e50;
            }
            
            .position-details {
                padding: 0 12px 12px 12px;
                background: white;
                margin: 0 12px 12px 12px;
                border-radius: 4px;
            }
            
            .expand-icon {
                font-size: 0.8em;
                color: #666;
                transition: transform 0.2s;
                min-width: 20px;
                text-align: center;
            }
            
            .expand-icon.expanded {
                transform: rotate(180deg);
            }
            
            .connection-item {
                padding: 6px 0;
                border-bottom: 1px solid #eee;
                color: #555;
                font-size: 0.9em;
            }
            
            .connection-item:last-child {
                border-bottom: none;
            }
            
            .no-connections {
                padding: 10px 0;
                color: #999;
                font-style: italic;
                font-size: 0.9em;
            }
            </style>
            
            <script>
            function toggleThemeDetails(themeId) {
                const details = document.getElementById('theme-details-' + themeId);
                const icon = document.getElementById('theme-icon-' + themeId);
                
                if (details.style.display === 'none' || details.style.display === '') {
                    details.style.display = 'block';
                    icon.classList.add('expanded');
                } else {
                    details.style.display = 'none';
                    icon.classList.remove('expanded');
                }
            }
            
            function togglePositionDetails(positionId) {
                const details = document.getElementById('pos-details-' + positionId);
                const icon = document.getElementById('pos-icon-' + positionId);
                
                if (details.style.display === 'none' || details.style.display === '') {
                    details.style.display = 'block';
                    icon.classList.add('expanded');
                } else {
                    details.style.display = 'none';
                    icon.classList.remove('expanded');
                }
            }
            </script>

        <!-- Comments Table -->
        <div class="section">
            <h2>Comments</h2>
            <div class="table-controls">
                <button class="clear-filters" onclick="clearAllFilters()">Clear All Filters</button>
                <div class="column-visibility-dropdown">
                    <button class="show-hide-columns" onclick="toggleColumnVisibility()">Show/Hide Columns</button>
                    <div class="column-visibility-content" id="columnVisibilityDropdown">
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-0" checked onchange="toggleColumn(0)">
                            <label for="col-0">Comment ID</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-1" checked onchange="toggleColumn(1)">
                            <label for="col-1">Date</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-2" checked onchange="toggleColumn(2)">
                            <label for="col-2">Submitter</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-3" checked onchange="toggleColumn(3)">
                            <label for="col-3">Organization</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-4" checked onchange="toggleColumn(4)">
                            <label for="col-4">Stances</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-5" checked onchange="toggleColumn(5)">
                            <label for="col-5">New Stances</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-6" checked onchange="toggleColumn(6)">
                            <label for="col-6">Comment</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-7" checked onchange="toggleColumn(7)">
                            <label for="col-7">Attachments</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-8" checked onchange="toggleColumn(8)">
                            <label for="col-8">Dup Count</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-9" checked onchange="toggleColumn(9)">
                            <label for="col-9">Dup Ratio</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-10" onchange="toggleColumn(10)">
                            <label for="col-10">Attachment</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-11" onchange="toggleColumn(11)">
                            <label for="col-11">Key Quote (LLM)</label>
                        </div>
                        <div class="column-visibility-item">
                            <input type="checkbox" id="col-12" onchange="toggleColumn(12)">
                            <label for="col-12">Rationale (LLM)</label>
                        </div>
                    </div>
                </div>
            </div>
                
            <div style="overflow-x: auto;">
                <table id="commentsTable" class="table table-striped">
                    <thead>
                        <tr>
                            <th class="filterable" data-column="0">
                                Comment ID <span class="filter-arrow" onclick="toggleFilter(0)">▼</span>
                                <div class="filter-dropdown" id="filter-0" style="display: none;">
                                    <input type="text" class="filter-input" data-column="0" placeholder="Filter ID..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th>Date</th>
                            <th class="filterable" data-column="2">
                                Submitter <span class="filter-arrow" onclick="toggleFilter(2)">▼</span>
                                <div class="filter-dropdown" id="filter-2" style="display: none;">
                                    <input type="text" class="filter-input" data-column="2" placeholder="Filter name..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="3">
                                Organization <span class="filter-arrow" onclick="toggleFilter(3)">▼</span>
                                <div class="filter-dropdown" id="filter-3" style="display: none;">
                                    <input type="text" class="filter-input" data-column="3" placeholder="Filter organization..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="4">
                                Stances <span class="filter-arrow" onclick="toggleFilter(4)">▼</span>
                                <div class="filter-dropdown" id="filter-4" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access" onchange="filterTable()"> COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market" onchange="filterTable()"> COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel" onchange="filterTable()"> Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage" onchange="filterTable()"> Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility" onchange="filterTable()"> Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Restoring and Building Public Trust: Trust Depends on Transparency and Safety" onchange="filterTable()"> Restoring and Building Public Trust: Trust Depends on Transparency and Safety</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Universal Vaccine Access: Support for Universal Vaccine Access" onchange="filterTable()"> Universal Vaccine Access: Support for Universal Vaccine Access</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Vaccine Safety and Harms: Vaccines Are Safe and Effective" onchange="filterTable()"> Vaccine Safety and Harms: Vaccines Are Safe and Effective</label><label class="filter-checkbox"><input type="checkbox" data-filter="stances" value="Vaccine Safety and Harms: Vaccines Are Unsafe" onchange="filterTable()"> Vaccine Safety and Harms: Vaccines Are Unsafe</label>
                                    <hr style="margin: 5px 0;">
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="unusual_combo" value="yes" onchange="filterTable()"> ⚠️ Unusual Combinations</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="5">
                                New Stances <span class="filter-arrow" onclick="toggleFilter(5)">▼</span>
                                <div class="filter-dropdown" id="filter-5" style="display: none;">
                                </div>
                            </th>
                            <th class="filterable" data-column="6">
                                Comment <span class="filter-arrow" onclick="toggleFilter(6)">▼</span>
                                <div class="filter-dropdown" id="filter-6" style="display: none;">
                                    <input type="text" class="filter-input" data-column="6" placeholder="Search comment text..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="7">
                                📎 <span class="filter-arrow" onclick="toggleFilter(7)">▼</span>
                                <div class="filter-dropdown" id="filter-7" style="display: none;">
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="attachments" value="yes" onchange="filterTable()"> With attachments</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-filter="attachments" value="no" onchange="filterTable()"> No attachments</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="8">
                                Dup Count <span class="filter-arrow" onclick="toggleFilter(8)">▼</span>
                                <div class="filter-dropdown" id="filter-8" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="duplication_count" value="1" onchange="filterTable()"> 1</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="9">
                                Dup Ratio <span class="filter-arrow" onclick="toggleFilter(9)">▼</span>
                                <div class="filter-dropdown" id="filter-9" style="display: none;"><label class="filter-checkbox"><input type="checkbox" data-filter="duplication_ratio" value="1" onchange="filterTable()"> 1:1</label>
                                </div>
                            </th>
                            <th class="filterable" data-column="10" style="display: none;">
                                Attachment <span class="filter-arrow" onclick="toggleFilter(10)">▼</span>
                                <div class="filter-dropdown" id="filter-10" style="display: none;">
                                    <input type="text" class="filter-input" data-column="10" placeholder="Search attachment text..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="11" style="display: none;">
                                Key Quote <span class="filter-arrow" onclick="toggleFilter(11)">▼</span>
                                <div class="filter-dropdown" id="filter-11" style="display: none;">
                                    <input type="text" class="filter-input" data-column="11" placeholder="Search quotes..." onkeyup="filterTable()">
                                </div>
                            </th>
                            <th class="filterable" data-column="12" style="display: none;">
                                Rationale <span class="filter-arrow" onclick="toggleFilter(12)">▼</span>
                                <div class="filter-dropdown" id="filter-12" style="display: none;">
                                    <input type="text" class="filter-input" data-column="12" placeholder="Search rationale..." onkeyup="filterTable()">
                                </div>
                            </th>
                        </tr>
                    </thead>
                        <tbody>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/CDC-2025-0024-9203" target="_blank" style="color: #007bff; text-decoration: underline;">CDC-2025-0024-9203</a></span></td>
                                <td class="date-cell">2025-06-23</td>
                                <td>Anonymous Anonymous</td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</span> <span class="stance-tag">Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</span> <span class="stance-tag">Universal Vaccine Access: Support for Universal Vaccine Access</span> <span class="stance-tag">Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="As a member of the public, I am deeply concerned about the practices, people, and events occurring around and within the Center for Disease Control&#039;s (CDC) Advisory Committee on Immunization Practices (ACIP).

Bypassing the ACIP, replacing its existing members with individuals who hold their own personal ethos above the general welfare of the nation, and restricting the public&#039;s access to life saving medicines are all acts that should be rejected, rectified, and addressed so they can happen again.

On June 9th, Robert F. Kennedy, Jr. (RFK Jr.) terminated all 17 members of the CDC ACIP.  These former members have an important role as independent expert scientists or clinicians on the ACIP committee with a crucial role in providing their understanding of the safety and efficacy of FDA-approved and authorized vaccines while also guiding insurance coverage and coverage for uninsured children through the Vaccines for Children program. Currently, vaccination rates for many infectious diseases are very low, and many communities across the US are directly affected by outbreaks of vaccine-preventable diseases such as measles, pertussis, and COVID. Many of these infections can cause serious and potentially lifelong consequences on their health. Children in 2025 should not die or become disabled from infectious diseases because of a lack of access to affordable and effective vaccines.

RFK Jr., Marty Makary, and Vinay Prasad have recently established policies that limit access to COVID ... [truncated]">As a member of the public, I am deeply concerned about the practices, people, and events occurring around and within the Center for Disease Control's (CDC) Advisory Committee on Immunization Practices (ACIP).

Bypassing the ACIP, replacing its existing members with individuals who hold their own per...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Everyone must have regular access to updated COVID vaccines and widely available with full coverage by health insurance.</td>
                                <td style="display: none;">The comment expresses strong support for public health measures and argues against limiting access to vaccines, highlighting the importance of expert committees and the role of vaccination in preventing serious health consequences. It also emphasizes the necessity of maintaining vaccine recommendations for insurance coverage, affirming the value of expert guidance in public health policy.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/CDC-2025-0024-9083" target="_blank" style="color: #007bff; text-decoration: underline;">CDC-2025-0024-9083</a></span></td>
                                <td class="date-cell">2025-06-23</td>
                                <td>Anonymous Anonymous</td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</span> <span class="stance-tag">Universal Vaccine Access: Support for Universal Vaccine Access</span> <span class="stance-tag">Committee Independence and Expertise: Support for Former (or Traditional) ACIP Expert Panel</span> <span class="stance-tag">Importance of Vaccine Recommendations for Insurance and Coverage: Support for Maintaining Recommendations to Guarantee Coverage</span> <span class="stance-tag">Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="To RFK Jr. and Members of the CDC ACIP committee:

I have no conflicts of interest to disclose.

Not all people will have the financial stability to afford vaccine and people&#039;s lives, regardless of income, matter. During this ongoing pandemic we need well educated scientific research based on facts and lengthy study, we need free COVID vaccine access for everyone above the age of 6 months. We need more scientists studying diseases, not politicians.
My comment is about the recent termination of all 17 members of the CDC ACIP committee announced on June 9 by Robert F. Kennedy, Jr. These former members have an important role as independent expert scientists or clinicians on the ACIP committee with a crucial role in providing their understanding of the safety and efficacy of FDA-approved and authorized vaccines while also guiding insurance coverage and coverage for uninsured children through the Vaccines for Children program. Currently, vaccination rates for many infectious diseases are very low, and many communities across the US are directly affected by outbreaks of vaccine-preventable diseases such as measles, pertussis, and COVID. Many of these infections can cause serious and potentially lifelong consequences on their health. Children in 2025 should not die or become disabled from infectious diseases because of a lack of access to affordable and effective vaccines. COVID vaccines must be available to everyone and not be limited to only some people.

RFK Jr., Marty Makary, an... [truncated]">To RFK Jr. and Members of the CDC ACIP committee:

I have no conflicts of interest to disclose.

Not all people will have the financial stability to afford vaccine and people's lives, regardless of income, matter. During this ongoing pandemic we need well educated scientific research based on facts ...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Children in 2025 should not die or become disabled from infectious diseases because of a lack of access to affordable and effective vaccines.</td>
                                <td style="display: none;">The selected theme:position combinations express a clear advocacy for continued COVID vaccine access and universal availability, emphasize the importance of expert scientific input through the ACIP committee, and highlight the necessity of maintaining insurance coverage for vaccines to protect public health, particularly for vulnerable populations.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/CDC-2025-0024-7969" target="_blank" style="color: #007bff; text-decoration: underline;">CDC-2025-0024-7969</a></span></td>
                                <td class="date-cell">2025-06-20</td>
                                <td>Teri Ann Wong</td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">COVID Vaccine Market Status: Support for Continued or Expanded COVID Vaccine Access</span> <span class="stance-tag">Vaccine Safety and Harms: Vaccines Are Safe and Effective</span> <span class="stance-tag">Public Health vs. Personal Autonomy: Emphasis on Public Health Responsibility</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="I have Covid that I contracted from my mother, who I live with. She got it shortly after coming home from a cruise that we were on. This was her first time getting it. She will be turning 90 this year. I am glad she kept up on her vaccine regimen. I have also kept up on my vaccines for Covid too.  We are recovering nicely and know this is because of the vaccines that has helped our bodies recognize and attack the viruses in our body. Please keep the Covid vaccines readily available because you never know when it will hit you.">I have Covid that I contracted from my mother, who I live with. She got it shortly after coming home from a cruise that we were on. This was her first time getting it. She will be turning 90 this year. I am glad she kept up on her vaccine regimen. I have also kept up on my vaccines for Covid too.  W...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">Please keep the Covid vaccines readily available because you never know when it will hit you.</td>
                                <td style="display: none;">The comment expresses strong support for maintaining access to COVID vaccines, emphasizing their effectiveness in aiding recovery and protecting vulnerable individuals. It highlights the belief that vaccines contribute to public health by helping individuals combat the virus, showcasing a reliance on vaccination as a means of safeguarding health.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/CDC-2025-0024-4432" target="_blank" style="color: #007bff; text-decoration: underline;">CDC-2025-0024-4432</a></span></td>
                                <td class="date-cell">2025-06-19</td>
                                <td>KAREN RUCAS</td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market</span> <span class="stance-tag">Vaccine Safety and Harms: Vaccines Are Unsafe</span> <span class="stance-tag">Restoring and Building Public Trust: Trust Depends on Transparency and Safety</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="ACIP – Want to Regain the Public’s Trust?
I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market. In 1976, the swine flu vaccine was immediately pulled after approximately 25 people died following vaccination. As of May 30, 2025, there have been 38,666 reports of deaths following COVID vaccination in the Vaccine Adverse Event Reporting System, yet this committee continues to recommend routine and repeated COVID shots. Additionally, I urge you to ensure that all vaccines will be subject to gold standard, double-blind inert placebo studies – a process that has not been in place for vaccines – before licensing. If ACIP is ever to regain the trust of the American people, it must start with removing COVID shot recommendations and establishing sound and rigorous research of all vaccines prior to marketing.">ACIP – Want to Regain the Public’s Trust?
I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market. In 1976, the swine flu vaccine was immediately pulled after approximately 25 people died following vaccination. As of May 30, 2025, the...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market.</td>
                                <td style="display: none;">The commenter explicitly calls for the removal of COVID vaccines from the market and references safety concerns using VAERS data. Additionally, there is an emphasis on the need for rigorous studies before licensing any vaccines, highlighting issues of trust and transparency, which aligns with the selected themes.</td>
                            </tr>

                            <tr>
                                <td><span class="comment-id"><a href="https://www.regulations.gov/comment/CDC-2025-0024-7657" target="_blank" style="color: #007bff; text-decoration: underline;">CDC-2025-0024-7657</a></span></td>
                                <td class="date-cell">2025-06-20</td>
                                <td>Christine Bennett</td>
                                <td></td>
                                <td><div class="stances-container"><span class="stance-tag">COVID Vaccine Market Status: Support for Removal of COVID Vaccines from Market</span> <span class="stance-tag">Vaccine Safety and Harms: Vaccines Are Unsafe</span> <span class="stance-tag">Restoring and Building Public Trust: Trust Depends on Transparency and Safety</span></div></td>
                                <td><span style="color: #999;">None</span></td>
                                <td class="text-preview char-limited" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="false" title="ACIP – Want to Regain the Public’s Trust?
I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market. In 1976, the swine flu vaccine was immediately pulled after approximately 25 people died following vaccination. As of May 30, 2025, there have been 38,666 reports of deaths following COVID vaccination in the Vaccine Adverse Event Reporting System, yet this committee continues to recommend routine and repeated COVID shots. Additionally, I urge you to ensure that all vaccines will be subject to gold standard, double-blind inert placebo studies – a process that has not been in place for vaccines – before licensing. If ACIP is ever to regain the trust of the American people, it must start with removing COVID shot recommendations and establishing sound and rigorous research of all vaccines prior to marketing.">ACIP – Want to Regain the Public’s Trust?
I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market. In 1976, the swine flu vaccine was immediately pulled after approximately 25 people died following vaccination. As of May 30, 2025, the...</td>
                                <td></td>
                                <td><span class="unique-indicator">1</span></td>
                                <td><span class="unique-indicator">1:1</span></td>
                                <td style="display: none;"></td>
                                <td style="display: none;">I urge ACIP members to take a firm stance for public health and remove all currently licensed COVID shots from the market.</td>
                                <td style="display: none;">The commenter explicitly advocates for the removal of all currently licensed COVID shots and cites significant death reports as justification, aligning with themes of vaccine safety concerns and the need to restore public trust through transparency in vaccine evaluation.</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Meta Information -->
        <div class="meta-info">
            <h3 style="color: white; margin-bottom: 20px;">📋 Report Details</h3>
            <div class="meta-grid">
                <div class="meta-item">
                    <div class="meta-label">Generated</div>
                    <div class="meta-value">2025-06-30 18:14:35</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Model Used</div>
                    <div class="meta-value">gpt-4o-mini</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Total Comments</div>
                    <div class="meta-value">5</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">With Attachments</div>
                    <div class="meta-value">0</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Average Length</div>
                    <div class="meta-value">1,775 chars</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Date Range</div>
                    <div class="meta-value">2025-06-19 to 2025-06-23</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Column visibility state (13 columns with new_stances)
        const columnVisibility = {
            0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true, 7: true, 8: true, 9: true, 10: false, 11: false, 12: false
        };

        // Initialize column visibility on page load
        document.addEventListener('DOMContentLoaded', function() {
            for (const [col, visible] of Object.entries(columnVisibility)) {
                updateColumnVisibility(parseInt(col), visible);
                // Also update the checkbox state
                const checkbox = document.getElementById('col-' + col);
                if (checkbox) {
                    checkbox.checked = visible;
                }
            }
        });

        function toggleColumnVisibility() {
            const dropdown = document.getElementById('columnVisibilityDropdown');
            dropdown.classList.toggle('show');
        }

        function toggleColumn(columnIndex) {
            const checkbox = document.getElementById('col-' + columnIndex);
            const visible = checkbox.checked;
            columnVisibility[columnIndex] = visible;
            updateColumnVisibility(columnIndex, visible);
        }

        function updateColumnVisibility(columnIndex, visible) {
            const table = document.getElementById('commentsTable');
            const rows = table.getElementsByTagName('tr');
            
            // Update header
            const headers = rows[0].getElementsByTagName('th');
            if (headers[columnIndex]) {
                headers[columnIndex].style.display = visible ? '' : 'none';
            }
            
            // Update all data rows
            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells[columnIndex]) {
                    cells[columnIndex].style.display = visible ? '' : 'none';
                }
            }
        }

        function filterTable() {
            const table = document.getElementById('commentsTable');
            const rows = table.getElementsByTagName('tr');
            
            // Get text input filters
            const textFilters = document.querySelectorAll('.filter-input');
            const textFilterValues = Array.from(textFilters).map(filter => {
                return {
                    column: parseInt(filter.getAttribute('data-column')),
                    value: filter.value.toLowerCase()
                };
            });
            
            // Get checkbox filters
            const stanceCheckboxes = document.querySelectorAll('input[data-filter="stances"]:checked');
            const newStanceCheckboxes = document.querySelectorAll('input[data-filter="new_stances"]:checked');
            const unusualComboCheckboxes = document.querySelectorAll('input[data-filter="unusual_combo"]:checked');
            const attachmentCheckboxes = document.querySelectorAll('input[data-filter="attachments"]:checked');
            const duplicationCountCheckboxes = document.querySelectorAll('input[data-filter="duplication_count"]:checked');
            const duplicationRatioCheckboxes = document.querySelectorAll('input[data-filter="duplication_ratio"]:checked');
            
            const selectedStances = Array.from(stanceCheckboxes).map(cb => cb.value.toLowerCase());
            const selectedNewStances = Array.from(newStanceCheckboxes).map(cb => cb.value.toLowerCase());
            const filterUnusualCombos = unusualComboCheckboxes.length > 0;
            const selectedAttachments = Array.from(attachmentCheckboxes).map(cb => cb.value);
            const selectedDuplicationCounts = Array.from(duplicationCountCheckboxes).map(cb => parseInt(cb.value));
            const selectedDuplicationRatios = Array.from(duplicationRatioCheckboxes).map(cb => parseInt(cb.value));

            // Always assume new_stances column exists (column 5)
            const hasNewStances = true;
            
            // Filter each row
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                const cells = row.getElementsByTagName('td');
                let showRow = true;

                // Check text filters
                for (const filter of textFilterValues) {
                    if (filter.value && filter.column < cells.length) {
                        const cellText = cells[filter.column].textContent.toLowerCase();
                        if (!cellText.includes(filter.value)) {
                            showRow = false;
                            break;
                        }
                    }
                }
                
                // Check stance filter (column 4)
                if (showRow && selectedStances.length > 0) {
                    const stanceText = cells[4].textContent.toLowerCase();
                    if (!selectedStances.some(stance => stanceText.includes(stance))) {
                        showRow = false;
                    }
                }
                
                // Check unusual combination filter
                if (showRow && filterUnusualCombos) {
                    const stanceCell = cells[4].innerHTML;
                    if (!stanceCell.includes('⚠️')) {
                        showRow = false;
                    }
                }
                
                // Check new stance filter (column 5 if exists)
                if (showRow && hasNewStances && selectedNewStances.length > 0) {
                    const newStanceText = cells[5].textContent.toLowerCase();
                    if (!selectedNewStances.some(stance => newStanceText.includes(stance))) {
                        showRow = false;
                    }
                }
                
                // Column positions shift by 1 when new_stances exists
                const attachmentCol = hasNewStances ? 7 : 6;
                const dupCountCol = hasNewStances ? 8 : 7;
                const dupRatioCol = hasNewStances ? 9 : 8;
                
                // Check attachments filter
                if (showRow && selectedAttachments.length > 0) {
                    const attachmentCell = cells[attachmentCol];
                    const hasAttachment = attachmentCell.textContent.trim() !== '';
                    
                    let attachmentMatch = false;
                    for (const filter of selectedAttachments) {
                        if (filter === 'yes' && hasAttachment) {
                            attachmentMatch = true;
                            break;
                        }
                        if (filter === 'no' && !hasAttachment) {
                            attachmentMatch = true;
                            break;
                        }
                    }
                    
                    if (!attachmentMatch) {
                        showRow = false;
                    }
                }
                
                // Check duplication count filter
                if (showRow && selectedDuplicationCounts.length > 0) {
                    const duplicationCell = cells[dupCountCol];
                    const duplicationText = duplicationCell.textContent.trim();
                    const duplicationCount = parseInt(duplicationText);
                    
                    if (!selectedDuplicationCounts.includes(duplicationCount)) {
                        showRow = false;
                    }
                }
                
                // Check duplication ratio filter
                if (showRow && selectedDuplicationRatios.length > 0) {
                    const ratioCell = cells[dupRatioCol];
                    const ratioText = ratioCell.textContent.trim();
                    // Extract number after "1:" (e.g., "1:10" -> 10)
                    const ratioMatch = ratioText.match(/1:(\d+)/);
                    const ratioValue = ratioMatch ? parseInt(ratioMatch[1]) : 1;
                    
                    if (!selectedDuplicationRatios.includes(ratioValue)) {
                        showRow = false;
                    }
                }

                row.style.display = showRow ? '' : 'none';
            }
        }
        
        function toggleFilter(columnIndex) {
            const dropdown = document.getElementById('filter-' + columnIndex);
            const allDropdowns = document.querySelectorAll('.filter-dropdown');
            
            // Close all other dropdowns
            allDropdowns.forEach(dd => {
                if (dd !== dropdown) {
                    dd.style.display = 'none';
                }});
            
            // Toggle current dropdown
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }
        
        function clearAllFilters() {
            const textFilters = document.querySelectorAll('.filter-input');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            
            textFilters.forEach(filter => filter.value = '');
            checkboxes.forEach(checkbox => checkbox.checked = false);
            
            filterTable();
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const isFilterClick = event.target.closest('.filterable') || event.target.closest('.filter-dropdown');
            const isColumnVisClick = event.target.closest('.column-visibility-dropdown');
            
            if (!isFilterClick) {
                document.querySelectorAll('.filter-dropdown').forEach(dd => {
                    dd.style.display = 'none';
                });
            }
            
            if (!isColumnVisClick) {
                document.getElementById('columnVisibilityDropdown').classList.remove('show');
            }
        });
        
        // Initialize Bootstrap tooltips
        function initializeTooltips() {
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
            [...tooltipTriggerList].forEach(tooltipTriggerEl => {
                try {
                    // Dispose existing tooltip if any
                    const existingTooltip = bootstrap.Tooltip.getInstance(tooltipTriggerEl);
                    if (existingTooltip) {
                        existingTooltip.dispose();
                    }
                    
                    // Create new tooltip
                    new bootstrap.Tooltip(tooltipTriggerEl, {
                        boundary: document.body,
                        trigger: 'hover focus',
                        container: 'body'
                    });
                } catch (err) {
                    console.error('Error initializing tooltip:', err);
                }
            });
        }
        
        // Initialize tooltips when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeTooltips();
        });
    </script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
